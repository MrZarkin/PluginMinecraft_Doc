# Commands & Broadcasts

Here are the changes that have been made.
### File created
NONE

## Modifications

### MonPluginListeners.java
```diff
import java.util.Arrays;

import org.bukkit.event.EventHandler;
import org.bukkit.enchantments.Enchantment;
import org.bukkit.event.Listener;
import org.bukkit.event.player.PlayerJoinEvent;
import org.bukkit.entity.Player;
import org.bukkit.inventory.ItemStack;
+import org.bukkit.inventory.Inventory;
import org.bukkit.inventory.ItemFlag;
import org.bukkit.inventory.meta.ItemMeta;
+import org.bukkit.Bukkit;
+import org.bukkit.GameMode;
import org.bukkit.Material;
import org.bukkit.event.player.PlayerInteractEvent;
import org.bukkit.potion.PotionEffect;
import org.bukkit.potion.PotionEffectType;
import org.bukkit.event.block.Action;
+import org.bukkit.event.inventory.InventoryClickEvent;

public class MonPluginListeners implements Listener 
{
    @EventHandler
    public void onJoin(PlayerJoinEvent event)
    {
        Player player = event.getPlayer();
        player.getInventory().clear();
        player.getInventory().addItem(new ItemStack(Material.DIAMOND_SWORD, 1));
        
        ItemStack customSword = new ItemStack(Material.DIAMOND_SWORD, 1);
        ItemMeta customM = customSword.getItemMeta();
        customM.setDisplayName("§6Titre d'arme perso");
        customM.setLore(Arrays.asList("§7Ceci est une arme", "§7Très puissante")); // Chaque texte = une ligne dans la description
        customM.addEnchant(Enchantment.DAMAGE_ALL, 5, true); // Enchantement / puissance / Le fixer
        customM.addItemFlags(ItemFlag.HIDE_ENCHANTS); // Cacher les enchantements
        customSword.setItemMeta(customM);

-       player.getInventory().setItemInOffHand(customSword); // setItemInMainHand

        ItemStack customwool = new ItemStack(Material.RED_WOOL, 1);

        player.getInventory().setHelmet(customwool);
+       player.getInventory().setItem(8, customSword); // Ajoute customSword dans l'inventaire du joueur (slot 8 = dernière case)

        player.updateInventory();
    }

    @EventHandler
    public void onInteract(PlayerInteractEvent event)
    {
        Player player = event.getPlayer();
        Action action = event.getAction();
        ItemStack item = event.getItem();

        if(item == null)
            return;

        if(item.getType() == Material.DIAMOND_HOE)
        {
            if(action == Action.RIGHT_CLICK_AIR)
            {
                player.sendMessage("Interaction completed!");
            }
        }

        if(item.getType() == Material.DIAMOND_SWORD && item.hasItemMeta() && item.getItemMeta().hasDisplayName() && item.getItemMeta().getDisplayName().equals("§6Titre d'arme perso"))
        {
            player.addPotionEffect(new PotionEffect(PotionEffectType.INCREASE_DAMAGE, Integer.MAX_VALUE, 1)); // Durée en ticks (20 = 1 seconde) / puissance

+            // Create GUI
+            Inventory inv = Bukkit.createInventory(null, 27, "Mon menu"); // Créé un inventaire de 27 slots (3 lignes de 9) avec pour nom "Mon menu"

+            inv.setItem(11, createItem(Material.ANVIL, "Passage en Gamemode 1")); // Place l'item apple dans le slot 11 de l'inventaire (2e ligne, 3e case)
+            inv.setItem(15, createItem(Material.BREAD, "Passage en Gamemode 0")); // Place l'item bread dans le slot 15 de l'inventaire (2e ligne, 7e case)

+            player.openInventory(inv); // Ouvre l'inventaire pour le joueur
        }
    }

+    @EventHandler
+    public void onClick(InventoryClickEvent event)
+    {
+        Player player = (Player) event.getWhoClicked();
+        ItemStack current = event.getCurrentItem();

+        if(current == null)
+            return;

+        if(event.getView().getTitle().equals("Mon menu")) // Vérifie que l'inventaire ouvert est bien celui créé plus haut
+        {
+            event.setCancelled(true); // Empeche de récuprérer l'item
+            player.closeInventory();

+            switch(current.getType())
+            {
+                case ANVIL:
+                    player.closeInventory();
+                    player.setGameMode(GameMode.CREATIVE);
+                    // player.chat("/test");  Force la commande, simule la saisie dans le chat
+                    player.sendMessage("Vous êtes maintenant en Gamemode 1");
+                    break;

+                case BREAD:
+                    player.closeInventory();
+                    player.setGameMode(GameMode.SURVIVAL);
+                    player.sendMessage("Vous êtes maintenant en Gamemode 0");
+                    player.getInventory().addItem(new ItemStack(Material.DIAMOND, 1)); // Ajoute un diamant dans l'inventaire
+                    break;

+                default:
+                    break;
+            }   
+        }
+    }

+    public ItemStack createItem(Material mat, String name)
+    {
+        ItemStack it = new ItemStack(mat, 1);
+        ItemMeta itM = it.getItemMeta();
+        itM.setDisplayName(name);
+        it.setItemMeta(itM);
+        return it;
+    }
}
```